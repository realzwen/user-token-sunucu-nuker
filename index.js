const axios=require('axios');const readline=require('readline');const rl=readline.createInterface({input:process.stdin,output:process.stdout});class DiscordClient{constructor(t){this.t=t;this.b='https://discord.com/api/v9';const s={"os":"Windows","browser":"Chrome","device":"","system_locale":"en-US","browser_user_agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36","browser_version":"120.0.0.0","os_version":"10","referrer":"","referring_domain":"","referrer_current":"","referring_domain_current":"","release_channel":"stable","client_build_number":261501,"client_event_source":null};this.c=axios.create({baseURL:this.b,headers:{'Authorization':this.t,'Content-Type':'application/json','User-Agent':'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36','X-Super-Properties':Buffer.from(JSON.stringify(s)).toString('base64'),'X-Discord-Locale':'en-US','X-Discord-Timezone':'America/New_York','Accept':'*/*','Accept-Language':'en-US,en;q=0.9','Origin':'https://discord.com','Referer':'https://discord.com/channels/@me','Sec-Ch-Ua':'"Not_A Brand";v="8", "Chromium";v="120", "Google Chrome";v="120"','Sec-Ch-Ua-Mobile':'?0','Sec-Ch-Ua-Platform':'"Windows"','Sec-Fetch-Dest':'empty','Sec-Fetch-Mode':'cors','Sec-Fetch-Site':'same-origin'}});}async g(){const r=await this.c.get('/users/@me/guilds');return r.data;}async ch(i){const r=await this.c.get(`/guilds/${i}/channels`);return r.data;}async ro(i){const r=await this.c.get(`/guilds/${i}/roles`);return r.data;}async dc(i){await this.c.delete(`/channels/${i}`);}async dr(g,r){await this.c.delete(`/guilds/${g}/roles/${r}`);}s(m){return new Promise(r=>setTimeout(r,m));}}function q(p){return new Promise((r)=>{rl.question(p,r);});}async function m(){console.clear();console.log('zwen\n');const t=await q('token: ');if(!t||t.trim()===''){console.log('error');rl.close();return;}const c=new DiscordClient(t.trim());console.log('\nloading...\n');try{const g=await c.g();if(!g||g.length===0){console.log('no servers');rl.close();return;}console.log('servers:\n');g.forEach((x,i)=>{console.log(`${i+1}. ${x.name}`);});const gc=await q('\nselect: ');const sg=g[parseInt(gc)-1];if(!sg){console.log('invalid');rl.close();return;}console.log(`\n${sg.name}\n`);console.log('loading...\n');const ch=await c.ch(sg.id);const ro=await c.ro(sg.id);console.log(`channels: ${ch.length}`);console.log(`roles: ${ro.length}\n`);console.log('1. delete channels');console.log('2. delete roles');console.log('3. delete all');console.log('4. exit\n');const o=await q('option: ');switch(o){case '1':await dac(c,ch);break;case '2':await dar(c,sg.id,ro);break;case '3':await da(c,sg.id,ch,ro);break;case '4':console.log('exit');break;default:console.log('invalid');}}catch(e){console.error('\nerror:',e.response?.status);if(e.response?.status===401){console.log('\ninvalid token');}else if(e.response?.status===403){console.log('\nno permission');}else if(e.response?.status===429){console.log('\nrate limit');}}rl.close();}async function dac(c,ch){console.log('\ndeleting...\n');let d=0;let f=0;for(const x of ch){try{await c.dc(x.id);d++;console.log(`[${d}/${ch.length}] ${x.name}`);await c.s(1000);}catch(e){f++;if(e.response?.status===429){console.log('rate limit 10s');await c.s(10000);}else{console.log(`${x.name} fail`);}}}console.log(`\n${d} ok ${f} fail`);}async function dar(c,g,ro){console.log('\ndeleting...\n');let d=0;let f=0;const dr=ro.filter(r=>r.name!=='@everyone');for(const x of dr){try{await c.dr(g,x.id);d++;console.log(`[${d}/${dr.length}] ${x.name}`);await c.s(1000);}catch(e){f++;if(e.response?.status===429){console.log('rate limit 10s');await c.s(10000);}else{console.log(`${x.name} fail`);}}}console.log(`\n${d} ok ${f} fail`);}async function da(c,g,ch,ro){console.log('\nstarting...\n');await dac(c,ch);console.log('\nroles...\n');await c.s(2000);await dar(c,g,ro);console.log('\ncompleted');}m();
// morelim bozuk ondan dolayı boyle yazdım btw
